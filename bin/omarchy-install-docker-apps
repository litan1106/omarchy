#!/bin/bash

options=("Spark" "Jaeger")

if [[ "$#" -eq 0 ]]; then
  choices=$(printf "%s\n" "${options[@]}" | gum choose --header "Select applications (space to select, return to install, esc to cancel)") || main_menu
else
  choices="$@"
fi

if [[ -n "$choices" ]]; then
  for app in $choices; do
    case $app in
    Spark) sudo docker run -d --restart unless-stopped --name spark-connect -p 15002:15002 -p 8080:8080 -p 7077:7077 -v "$HOME/Work":"/home/$USER/Work" apache/spark:4.0.1-scala2.13-java21-ubuntu /opt/spark/sbin/start-connect-server.sh --wait;;
    Jaeger) sudo docker run -d --restart unless-stopped --name jaeger -p 16686:16686 -p 4317:4317 -p 4318:4318 -p 5778:5778 -p 9411:9411 cr.jaegertracing.io/jaegertracing/jaeger:2.11.0 ;;
    esac
  done
else
  echo "No applications selected for installation."
fi